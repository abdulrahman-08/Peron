"use strict";(self.webpackChunkPeron=self.webpackChunkPeron||[]).push([[301],{6301:(M,g,p)=>{p.r(g),p.d(g,{OtpComponent:()=>P});var a=p(9417),h=p(9909),d=p(177),c=p(7735),e=p(6996),f=p(4796),O=p(8756);const b=["otp1","otp2","otp3","otp4"];function T(u,v){1&u&&e.nrm(0,"i",29)}function C(u,v){if(1&u&&(e.j41(0,"p",30),e.EFF(1),e.k0s()),2&u){const n=e.XpG();e.R7$(1),e.JRh(n.mserror)}}let P=(()=>{class u{constructor(n,r,t,i,o){this._AuthService=n,this._Router=r,this._FormBuilder=t,this.translate=i,this.languageService=o,this.mserror="",this.spincheak=!1,this.otp=["","","",""],this.timer="00:51",this.isResendDisabled=!0,this.emailOrPhone="",this.currentLang="en",this.OTPForm=this._FormBuilder.group({otp0:[null,a.k0.required],otp1:[null,a.k0.required],otp2:[null,a.k0.required],otp3:[null,a.k0.required]})}ngOnInit(){this.languageService.currentLang$.subscribe(n=>{this.currentLang=n,this.translate.use(n)}),this.languageService.loadSavedLang(),this.startTimer(),this.emailOrPhone=this._AuthService.getemailOrPhone()}moveToNext(n,r){1===n.value.length&&r?r.focus():1===n.value.length&&null==r&&(n.blur(),console.log(this.OTPForm.value))}updateBorder(n,r){n.value?n.classList.add("filled"):n.classList.remove("filled")}onKeyDown(n,r,t,i,o){n.ctrlKey&&"v"===n.key.toLowerCase()?setTimeout(()=>{this.onPaste(n,r)},50):"Backspace"===n.key&&(""!==t.value.trim()?(this.otp[r]="",t.value="",n.preventDefault()):o&&(n.preventDefault(),o.focus()))}onPaste(n,r){n.preventDefault();const i=(n.clipboardData?.getData("text")||"").replace(/\D/g,"");for(let o=0;o<i.length;o++)r+o<4&&(this.otp[r+o]=i[o],this.OTPForm.get(`otp${r+o}`)?.setValue(i[o]),this.updateBorder(this.inputs.toArray()[r+o].nativeElement,r+o))}startTimer(){let n=51;this.isResendDisabled=!0,this.countdown=setInterval(()=>{if(n<=0)clearInterval(this.countdown),this.timer="00:00",this.isResendDisabled=!1;else{Math.floor(n/60);let t=n%60;this.timer=`00:${t<10?"0"+t:t}`,n--}},1e3)}resendOtp(){this.isResendDisabled||(clearInterval(this.countdown),this.timer="00:51",this.startTimer(),this._AuthService.forgetpassword({email:this.emailOrPhone}).subscribe({next:n=>{console.log(n)},error:n=>{this.mserror=n.error.message,console.log(n)}}))}sendOtp(){if(this.OTPForm.valid){this.spincheak=!0;const r=Object.values(this.OTPForm.value).join("");this._AuthService.setOtp(r),this._AuthService.sendOtpToResetPassword({email:this.emailOrPhone,otpCode:r}).subscribe({next:i=>{this._Router.navigate(["/auth/newPassword"]),this.spincheak=!1,console.log(i)},error:i=>{this.spincheak=!1,this.mserror=i.error.message,console.log(i)}})}else this.mserror="Please Enter Your OTP"}static{this.\u0275fac=function(r){return new(r||u)(e.rXU(f.u),e.rXU(h.Ix),e.rXU(a.ok),e.rXU(c.c$),e.rXU(O.g))}}static{this.\u0275cmp=e.VBU({type:u,selectors:[["app-otp"]],viewQuery:function(r,t){if(1&r&&e.GBs(b,5),2&r){let i;e.mGM(i=e.lsd())&&(t.inputs=i)}},standalone:!0,features:[e.aNF],decls:43,vars:26,consts:[[1,"login-container","d-flex","flex-column","min-vh-100",3,"dir"],[1,"text-center","mt-2","p-2",2,"z-index","3"],[1,"d-flex","align-items-center","justify-content-center"],["src","./assets/imgs/logo.png","alt","Peron Logo",1,"me-3",2,"width","90px","height","90px"],[1,"brand-name"],[1,"color","position-absolute","top-0","bottom-0","start-0","end-0"],[1,"col-10","col-sm-8","col-md-5","mt-5","col-lg-5","m-auto",2,"z-index","3"],[1,"login-form","card","p-5","shadow"],["routerLink","/auth/forget-password",1,"text-decoration-none","fw-normal",2,"color","#292828"],[1,"fa-solid","mt-2","fs-6","p-0",3,"ngClass"],[1,"card-body","p-4"],[1,"text-center","mb-3","fw-bold"],[1,"text-center","text-muted"],[3,"formGroup","ngSubmit"],[1,"otp-inputs"],["type","tel","maxlength","1","formControlName","otp0",1,"otp-box",3,"ngModelChange","blur","keydown","paste"],["otp1",""],["type","text","maxlength","1","formControlName","otp1",1,"otp-box",3,"ngModelChange","blur","keydown","paste"],["otp2",""],["type","text","maxlength","1","formControlName","otp2",1,"otp-box",3,"ngModelChange","blur","keydown","paste"],["otp3",""],["type","text","maxlength","1","formControlName","otp3",1,"otp-box",3,"blur","ngModelChange","keydown","paste"],["otp4",""],[1,"d-flex","justify-content-around","align-items-center","mt-3"],[1,"otp-timer","mb-0","text-black"],[1,"resend",3,"click"],["type","submit",1,"btn","w-100","btn-success","mt-3"],["class","fas me-1 fa-spin fa-spinner",4,"ngIf"],["class","alert text-danger",4,"ngIf"],[1,"fas","me-1","fa-spin","fa-spinner"],[1,"alert","text-danger"]],template:function(r,t){if(1&r){const i=e.RV6();e.j41(0,"div",0)(1,"header",1)(2,"div",2),e.nrm(3,"img",3),e.j41(4,"span",4),e.EFF(5),e.nI1(6,"translate"),e.k0s()()(),e.nrm(7,"div",5),e.j41(8,"div",6)(9,"div",7)(10,"a",8),e.nrm(11,"i",9),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.j41(14,"div",10)(15,"h2",11),e.EFF(16),e.nI1(17,"translate"),e.k0s(),e.j41(18,"p",12),e.EFF(19),e.nI1(20,"translate"),e.k0s(),e.j41(21,"form",13),e.bIt("ngSubmit",function(){return t.sendOtp()}),e.j41(22,"div")(23,"div",14)(24,"input",15,16),e.bIt("ngModelChange",function(){e.eBV(i);const s=e.sdS(25),l=e.sdS(27);return e.Njj(t.moveToNext(s,l))})("blur",function(){e.eBV(i);const s=e.sdS(25);return e.Njj(t.updateBorder(s,0))})("keydown",function(s){e.eBV(i);const l=e.sdS(25),_=e.sdS(27);return e.Njj(t.onKeyDown(s,0,l,_))})("paste",function(s){return t.onPaste(s,0)}),e.k0s(),e.j41(26,"input",17,18),e.bIt("ngModelChange",function(){e.eBV(i);const s=e.sdS(27),l=e.sdS(29);return e.Njj(t.moveToNext(s,l))})("blur",function(){e.eBV(i);const s=e.sdS(27);return e.Njj(t.updateBorder(s,1))})("keydown",function(s){e.eBV(i);const l=e.sdS(27),_=e.sdS(29),m=e.sdS(25);return e.Njj(t.onKeyDown(s,1,l,_,m))})("paste",function(s){return t.onPaste(s,1)}),e.k0s(),e.j41(28,"input",19,20),e.bIt("ngModelChange",function(){e.eBV(i);const s=e.sdS(29),l=e.sdS(31);return e.Njj(t.moveToNext(s,l))})("blur",function(){e.eBV(i);const s=e.sdS(29);return e.Njj(t.updateBorder(s,2))})("keydown",function(s){e.eBV(i);const l=e.sdS(29),_=e.sdS(31),m=e.sdS(27);return e.Njj(t.onKeyDown(s,2,l,_,m))})("paste",function(s){return t.onPaste(s,2)}),e.k0s(),e.j41(30,"input",21,22),e.bIt("blur",function(){e.eBV(i);const s=e.sdS(31);return e.Njj(t.updateBorder(s,3))})("ngModelChange",function(){e.eBV(i);const s=e.sdS(31);return e.Njj(t.moveToNext(s,null))})("keydown",function(s){e.eBV(i);const l=e.sdS(31),_=e.sdS(29);return e.Njj(t.onKeyDown(s,3,l,void 0,_))})("paste",function(s){return t.onPaste(s,3)}),e.k0s()(),e.j41(32,"div",23)(33,"p",24),e.EFF(34),e.k0s(),e.j41(35,"a",25),e.bIt("click",function(){return t.resendOtp()}),e.EFF(36),e.nI1(37,"translate"),e.k0s()()(),e.j41(38,"button",26),e.DNE(39,T,1,0,"i",27),e.EFF(40),e.nI1(41,"translate"),e.k0s(),e.DNE(42,C,2,1,"p",28),e.k0s()()()()()}2&r&&(e.Y8G("dir","ar"===t.currentLang?"rtl":"ltr"),e.R7$(5),e.JRh(e.bMT(6,14,"FOOTER.BRAND_NAME")),e.R7$(6),e.Y8G("ngClass","en"===t.currentLang?"fa-arrow-left":"fa-arrow-right"),e.R7$(1),e.SpI(" ",e.bMT(13,16,"ENTER_OTP.BACK")," "),e.R7$(4),e.JRh(e.bMT(17,18,"ENTER_OTP.TITLE")),e.R7$(3),e.JRh(e.bMT(20,20,"ENTER_OTP.DESCRIPTION")),e.R7$(2),e.Y8G("formGroup",t.OTPForm),e.R7$(13),e.JRh(t.timer),e.R7$(1),e.AVh("disabled",t.isResendDisabled),e.R7$(1),e.JRh(e.bMT(37,22,"ENTER_OTP.RESEND")),e.R7$(3),e.Y8G("ngIf",t.spincheak),e.R7$(1),e.SpI(" ",e.bMT(41,24,"ENTER_OTP.SUBMIT_BUTTON")," "),e.R7$(2),e.Y8G("ngIf",t.mserror))},dependencies:[d.MD,d.YU,d.bT,a.YN,a.qT,a.me,a.BC,a.cb,a.tU,a.X1,a.j4,a.JD,h.Wk,c.h,c.D9],styles:['@import"https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&display=swap";.login-container[_ngcontent-%COMP%]{padding:0;background-image:url(otp.9d6b714b51af6b5e.png);background-size:cover;background-position:center;margin:0}.color[_ngcontent-%COMP%]{background-color:#000000a8;z-index:2}.brand-name[_ngcontent-%COMP%]{color:#fff;font-size:40px;font-family:IBM Plex Sans,sans-serif;font-weight:500}.resend.disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#ccc;pointer-events:none}.login-form[_ngcontent-%COMP%]{border-radius:10px;box-shadow:0 0 10px #0000001a}.otp-inputs[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin:15px 0}.otp-box[_ngcontent-%COMP%]{width:60px;height:60px;font-size:24px;color:var(--main-color);text-align:center;border:2px solid #ccc;font-weight:600;border-radius:8px;outline:none;transition:all .1ms ease-in-out}.otp-box.filled[_ngcontent-%COMP%]{border:2px solid var(--main-color)}.otp-box[_ngcontent-%COMP%]:focus{border:2px solid royalblue;color:#4169e1}.otp-timer[_ngcontent-%COMP%]{font-size:14px;color:gray}.resend[_ngcontent-%COMP%]{color:#006400;font-weight:400;cursor:pointer;text-decoration:none}']})}}return u})()}}]);